"use strict";(self.webpackChunklukso_docs=self.webpackChunklukso_docs||[]).push([[1141],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,v=u["".concat(l,".").concat(m)]||u[m]||p[m]||i;return n?a.createElement(v,s(s({ref:t},d),{},{components:n})):a.createElement(v,s({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:r,s[1]=o;for(var c=2;c<i;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9373:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return o},metadata:function(){return c},toc:function(){return p}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),s=["components"],o={sidebar_label:"LSP1 - Universal Receiver Delegate",sidebar_position:3},l="LSP1 - Universal Receiver Delegate",c={unversionedId:"standards/universal-profile/lsp1-universal-receiver-delegate",id:"standards/universal-profile/lsp1-universal-receiver-delegate",title:"LSP1 - Universal Receiver Delegate",description:"LSP1 - Universal Receiver Delegate",source:"@site/docs/standards/universal-profile/02-lsp1-universal-receiver-delegate.md",sourceDirName:"standards/universal-profile",slug:"/standards/universal-profile/lsp1-universal-receiver-delegate",permalink:"/standards/universal-profile/lsp1-universal-receiver-delegate",editUrl:"https://github.com/lukso-network/docs/tree/main/docs/standards/universal-profile/02-lsp1-universal-receiver-delegate.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_label:"LSP1 - Universal Receiver Delegate",sidebar_position:3},sidebar:"standardsSidebar",previous:{title:"LSP0 - ERC725 Account",permalink:"/standards/universal-profile/lsp0-erc725account"},next:{title:"LSP3 - Universal Profile - Metadata",permalink:"/standards/universal-profile/lsp3-universal-profile-metadata"}},d={},p=[{value:"Introduction",id:"introduction",level:2},{value:"What does this standard represent ?",id:"what-does-this-standard-represent-",level:2},{value:"Specification",id:"specification",level:3},{value:"How Delegation works",id:"how-delegation-works",level:3},{value:"Implementations",id:"implementations",level:2},{value:"Token transfer scenario",id:"token-transfer-scenario",level:3},{value:"References",id:"references",level:2}],u={toc:p};function m(e){var t=e.components,o=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"lsp1---universal-receiver-delegate"},"LSP1 - Universal Receiver Delegate"),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Standard Document")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-1-UniversalReceiver.md#specification-of-the-universalreceiverdelegate"},"LSP1 - Universal Receiver Delegate")))),(0,i.kt)("div",{className:"admonition admonition-success alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Recommendation")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"For a better understanding of this standard, it is ",(0,i.kt)("strong",{parentName:"p"},"well-advised")," to check first the origin standard ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/standards/generic-standards/lsp1-universal-receiver"},"LSP1-UniversalReceiver")),"."))),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"Once deployed, the code of a smart contract ",(0,i.kt)("strong",{parentName:"p"},"can not be changed"),". However, the way a smart contract implements the ",(0,i.kt)("a",{parentName:"p",href:"/standards/smart-contracts/lsp0-erc725-account#universalreceiver"},(0,i.kt)("inlineCode",{parentName:"a"},"universalReceiver(...)"))," function and how it reacts could change and evolve in the future."),(0,i.kt)("p",null,"Therefore, it is advised not to hardcode how the smart contract should handle and react to certain calls inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function, but instead to delegate this functionality to another external contract. Such contract could then be customized to implement a specific logic that could be changed anytime ",(0,i.kt)("strong",{parentName:"p"},"via an upgrade"),"."),(0,i.kt)("h2",{id:"what-does-this-standard-represent-"},"What does this standard represent ?"),(0,i.kt)("h3",{id:"specification"},"Specification"),(0,i.kt)("p",null,"This standard represents a smart contract that is delegated the initial ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function."),(0,i.kt)("p",null,"It contains a single function named ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiverDelegate(...)")," that takes the same parameters as the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function with an additional parameter:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"address ",(0,i.kt)("inlineCode",{parentName:"li"},"sender"),": the address that initially called the ",(0,i.kt)("inlineCode",{parentName:"li"},"universalReceiver(...)")," function.")),(0,i.kt)("h3",{id:"how-delegation-works"},"How Delegation works"),(0,i.kt)("p",null,"In order to let the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function forward the call to the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiverDelegate(...)")," function, the address of the ",(0,i.kt)("strong",{parentName:"p"},"UniversalReceiverDelegate")," contract should be set as a value for the key ",(0,i.kt)("inlineCode",{parentName:"p"},"LSP1UniversalReceiver"),", inside the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/ERC725Alliance/erc725/blob/main/docs/ERC-725.md#erc725y"},"ERC725Y key-value store")," of the implementation contract (contract implementing the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function)."),(0,i.kt)("p",null,"This external contract will then implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiverDelegate(...)")," function. It is also recommended that this contract registers the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/standards/smart-contracts/interface-ids"},"LSP1UniversalReceiverDelegate interfaceId"))," using ERC165."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"ur-delegate-transaction",src:n(3173).Z,width:"2494",height:"1432"})),(0,i.kt)("h2",{id:"implementations"},"Implementations"),(0,i.kt)("p",null,"There are several implementations of the standard. The ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/standards/smart-contracts/lsp1-universal-receiver-delegate-up"},"LSP1UniversalReceiverDelegateUP"))," contract is one of them and is used as a delegate to the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function of ",(0,i.kt)("strong",{parentName:"p"},"UniversalProfile")," contract."),(0,i.kt)("p",null,"At the moment, this contract allows to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"receive and send tokens & vaults"),(0,i.kt)("li",{parentName:"ul"},"register the keys representing them according to ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-5-ReceivedAssets.md"},"LSP5-ReceivedAssets"))," and ",(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-10-ReceivedVaults.md"},"LSP10-ReceivedVaults"))," Standards.")),(0,i.kt)("h3",{id:"token-transfer-scenario"},"Token transfer scenario"),(0,i.kt)("p",null,"One of the possible scenarios is a token transfer between Alice and Bob. Alice wants to transfer a token owned by her Universal Profile to the Universal Profile of her friend Bob."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"1.")," It calls the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"transfer(...)"))," function on the token contract through the KeyManager."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"executing transfer function",src:n(73).Z,width:"1542",height:"648"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"2.")," The ",(0,i.kt)("inlineCode",{parentName:"p"},"transfer(...)")," function on the token contract will directly ",(0,i.kt)("strong",{parentName:"p"},"trigger a hook")," that will call the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function on both sender and recipient Universal Profiles."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"token contract hooks calling universalReceiver function",src:n(5722).Z,width:"1706",height:"585"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"3.")," 3. If the ",(0,i.kt)("strong",{parentName:"p"},"UniversalReceiverDelegate")," contract is set, it will be called by the ",(0,i.kt)("inlineCode",{parentName:"p"},"universalReceiver(...)")," function and will execute its custom logic."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"universalReceiver function calling UniversalReceiverDelegate contract",src:n(5882).Z,width:"1358",height:"736"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"4.")," The ",(0,i.kt)("strong",{parentName:"p"},"UniversalReceiverDelegate")," of ",(0,i.kt)("strong",{parentName:"p"},"Universal Profile")," allows the transfer and set ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-5-ReceivedAssets.md"},"LSP5-ReceivedAssets"))," keys on both Profiles through the KeyManager."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"UniversalReceiverDelegate setting keys on profile",src:n(828).Z,width:"1410",height:"610"})),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-1-UniversalReceiver.md"},"LUKSO Standards Proposals: LSP1 - Universal Receiver (Standard Specification, GitHub)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/lukso-network/lsp-universalprofile-smart-contracts/tree/develop/contracts/LSP1UniversalReceiver"},"LSP1 Universal Receiver: Solidity implementations (GitHub)"))))}m.isMDXComponent=!0},73:function(e,t,n){t.Z=n.p+"assets/images/token-transfer-1-562434a3f4db2f5f0da00daff53e641d.jpg"},5722:function(e,t,n){t.Z=n.p+"assets/images/token-transfer-2-869f736fd80789482b288f754fd65305.jpg"},5882:function(e,t,n){t.Z=n.p+"assets/images/token-transfer-3-cef81d8ed641f488398df3436a910649.jpg"},828:function(e,t,n){t.Z=n.p+"assets/images/token-transfer-4-8e42db7583b60f3ecfebab8ab51a5875.jpg"},3173:function(e,t,n){t.Z=n.p+"assets/images/ur-delegate-transaction-815e4ec6629f95fb66dc5a6a4f92f3e9.jpeg"}}]);