"use strict";(self.webpackChunklukso_docs=self.webpackChunklukso_docs||[]).push([[9704],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),d=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=d(a),k=r,u=c["".concat(l,".").concat(k)]||c[k]||m[k]||i;return a?n.createElement(u,s(s({ref:t},p),{},{components:a})):n.createElement(u,s({ref:t},p))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=c;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:r,s[1]=o;for(var d=2;d<i;d++)s[d]=a[d];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},3517:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return d},toc:function(){return p},default:function(){return h}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),s=["components"],o={sidebar_label:"LSP6 - Key Manager",sidebar_position:5},l="LSP6 - Key Manager",d={unversionedId:"standards/universal-profile/lsp6-key-manager",id:"standards/universal-profile/lsp6-key-manager",title:"LSP6 - Key Manager",description:"LSP6 - Key Manager",source:"@site/docs/standards/universal-profile/04-lsp6-key-manager.md",sourceDirName:"standards/universal-profile",slug:"/standards/universal-profile/lsp6-key-manager",permalink:"/standards/universal-profile/lsp6-key-manager",editUrl:"https://github.com/lukso-network/docs/tree/main/docs/standards/universal-profile/04-lsp6-key-manager.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_label:"LSP6 - Key Manager",sidebar_position:5},sidebar:"standardsSidebar",previous:{title:"LSP3 - Universal Profile - Metadata",permalink:"/standards/universal-profile/lsp3-universal-profile-metadata"},next:{title:"LSP5 - Received Assets",permalink:"/standards/universal-profile/lsp5-received-assets"}},p=[{value:"Introduction",id:"introduction",children:[],level:2},{value:"Types of permissions",id:"types-of-permissions",children:[{value:"Address Permissions",id:"address-permissions",children:[],level:3},{value:"Allowed addresses",id:"allowed-addresses",children:[],level:3},{value:"Allowed functions",id:"allowed-functions",children:[],level:3},{value:"Allowed standards",id:"allowed-standards",children:[],level:3},{value:"Allowed ERC725Y Keys",id:"allowed-erc725y-keys",children:[],level:3}],level:2},{value:"Permission Keys",id:"permission-keys",children:[],level:2},{value:"Permission Values",id:"permission-values",children:[],level:2},{value:"References",id:"references",children:[],level:2}],m=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)}},c=m("Tabs"),k=m("TabItem"),u={toc:p};function h(e){var t=e.components,o=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"lsp6---key-manager"},"LSP6 - Key Manager"),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Standard Document")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md"},"LSP6 - Key Manager")))),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"An ",(0,i.kt)("a",{parentName:"p",href:"/standards/universal-profile/lsp0-erc725account"},"ERC725Account")," on its own comes with limited usability. Since it is an ",(0,i.kt)("strong",{parentName:"p"},"owned contract"),", only the Account's owner can write data into it or use it to interact with other smart contracts."),(0,i.kt)("p",null,"Here comes the Key Manager. A smart contract that controls an ERC725Account, acting as its new owner. It then functions as a gateway for an ERC725Account."),(0,i.kt)("p",null,"The idea is to give ",(0,i.kt)("a",{parentName:"p",href:"#types-of-permissions"},"permissions")," to any ",(0,i.kt)("inlineCode",{parentName:"p"},"address"),", like Externally Owned Accounts (EOA) or smart contracts. These can then interact with the ERC725Account ",(0,i.kt)("strong",{parentName:"p"},"through the Key Manager"),". The Key Manager will allow or restrict access based on the permissions set for the calling ",(0,i.kt)("inlineCode",{parentName:"p"},"address"),"."),(0,i.kt)("p",null,"\u274c ","\xa0"," ",(0,i.kt)("strong",{parentName:"p"},"Without a Key Manager"),", only the ERC725Account's owner can use its Account."),(0,i.kt)("p",null,"\u2705 ","\xa0"," ",(0,i.kt)("strong",{parentName:"p"},"With a Key Manager")," attached to an ERC725Account, other addresses (EOAs or contracts) can use an Account on behalf of its owner."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"LSP6 Key Manager overview allowed",src:a(9411).Z,width:"1427",height:"700"})),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"LSP6 Key Manager overview not allowed",src:a(5220).Z,width:"1407",height:"710"})),(0,i.kt)("p",null,"Permissions for addresses are not stored on the Key Manager. Instead, they are ",(0,i.kt)("strong",{parentName:"p"},"stored inside the key-value store of the ERC725Account")," linked to the Key Manager. This way, it is possible to easily ",(0,i.kt)("strong",{parentName:"p"},"upgrade")," the Key Manager without having to reset all the permissions again."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"You can look at the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#permissions-keys"},"Permission Keys"))," section to find under which keys these permissions are stored.")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"types-of-permissions"},"Types of permissions"),(0,i.kt)("p",null,"Five main types of permissions can be set for addresses interacting with a Universal Profile."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#address-permissions"},(0,i.kt)("strong",{parentName:"a"},"Address Permissions")),": defines a set of ",(0,i.kt)("a",{parentName:"p",href:"#permissions-value"},(0,i.kt)("strong",{parentName:"a"},"permission values"))," for an ",(0,i.kt)("inlineCode",{parentName:"p"},"address"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#allowed-addresses"},(0,i.kt)("strong",{parentName:"a"},"Allowed Addresses:"))," defines which EOA or contract addresses an ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," is ",(0,i.kt)("em",{parentName:"p"},"allowed to")," interact with.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#allowed-functions"},(0,i.kt)("strong",{parentName:"a"},"Allowed Functions:"))," defines which ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://docs.soliditylang.org/en/v0.8.12/abi-spec.html?highlight=selector#function-selector"},"function selector(s)"))," an ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," is allowed to run on a specific contract.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#allowed-standards"},(0,i.kt)("strong",{parentName:"a"},"Allowed Standards"))," defines a list of interfaces standards an ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," is allowed to interact with when calling contracts (using ",(0,i.kt)("a",{parentName:"p",href:"https://eips.ethereum.org/EIPS/eip-165"},"ERC165")," and ",(0,i.kt)("a",{parentName:"p",href:"/standards/smart-contracts/interface-ids"},"interface ids"),").")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("a",{parentName:"p",href:"#allowed-erc725y-keys"},(0,i.kt)("strong",{parentName:"a"},"Allowed ERC725Y Keys: "))," defines a list of ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes32")," ERC725Y keys an ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," is only allowed to set when doing ",(0,i.kt)("a",{parentName:"p",href:"/standards/smart-contracts/lsp0-erc725-account#setdata"},(0,i.kt)("inlineCode",{parentName:"a"},"setData(...)"))," on the linked ERC725Account."))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("strong",{parentName:"p"},"About Allowed addresses, functions, standards and ERC725Y keys.")),(0,i.kt)("p",{parentName:"div"},"To add or remove entries in these list (of addresses, ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes4")," function selectors, ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes4")," interface ids, or ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes32")," keys), the ",(0,i.kt)("strong",{parentName:"p"},"whole array")," should be abi-encoded again and reset. Each update ",(0,i.kt)("strong",{parentName:"p"},"overrides the entire previous state"),"."),(0,i.kt)("p",{parentName:"div"},"This is an ",(0,i.kt)("strong",{parentName:"p"},"expensive operation"),", since the data being set is an abi-encoded array."),(0,i.kt)("p",{parentName:"div"},"The tool ",(0,i.kt)("a",{parentName:"p",href:"/tools/erc725js/classes/ERC725"},"erc725.js")," can will help for ",(0,i.kt)("a",{parentName:"p",href:"/tools/erc725js/classes/ERC725#encodedata"},"encoding the keys and values"),"."))),(0,i.kt)("h3",{id:"address-permissions"},"Address Permissions"),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"See the section ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"#permission-values"},"Permissions Values"))," to know ",(0,i.kt)("strong",{parentName:"p"},"what each permission enables")," and ",(0,i.kt)("strong",{parentName:"p"},"how to combine them"),"."))),(0,i.kt)("p",null,"An address can hold one (or more) permissions, enabling it to perform multiple ",(0,i.kt)("em",{parentName:"p"},'"actions"')," on an ERC725Account. Such ",(0,i.kt)("em",{parentName:"p"},'"actions"')," include ",(0,i.kt)("strong",{parentName:"p"},"setting data")," on the ERC725Account, ",(0,i.kt)("strong",{parentName:"p"},"calling other contracts"),", ",(0,i.kt)("strong",{parentName:"p"},"transferring native tokens")," and more."),(0,i.kt)("p",null,"To grant permission(s) to an ",(0,i.kt)("inlineCode",{parentName:"p"},"<address>"),", set the following key-value pair below in the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/ethereum/EIPs/blob/master/EIPS/eip-725.md#erc725y"},"ERC725Y")," contract storage."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"0x4b80742d0000000082ac0000<address>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"value:")," one of the available options below.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "AddressPermissions:Permissions:<address>",\n  "key": "0x4b80742d0000000082ac0000<address>",\n  "keyType": "Bytes20MappingWithGrouping",\n  "valueType": "bytes32",\n  "valueContent": "BitArray"\n}\n')),(0,i.kt)("p",null,"See the table below for each permission and their corresponding ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes32")," value."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Permission Name"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"CHANGEOWNER")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000001"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"CHANGEPERMISSIONS")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000002"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"ADDPERMISSIONS")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000004"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"SETDATA")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000008"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"CALL")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000010"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"STATICCALL")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000020"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"DELEGATECALL")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000040"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"DEPLOY")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000080"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"TRANSFERVALUE")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000100"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#permission-values"},"SIGN")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x0000000000000000000000000000000000000000000000000000000000000200"))))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Each permission MUST be:"),(0,i.kt)("ul",{parentName:"div"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"exactly 32 bytes long")),(0,i.kt)("li",{parentName:"ul"},"zero left-padded",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"0x0000000000000000000000000000000000000000000000000000000000000008")," \u2705"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"0x0800000000000000000000000000000000000000000000000000000000000000")," \u274c")))),(0,i.kt)("p",{parentName:"div"},"For instance, if you try to set the permission SETDATA for an address as ",(0,i.kt)("inlineCode",{parentName:"p"},"0x08"),", this will be stored internally as ",(0,i.kt)("inlineCode",{parentName:"p"},"0x0800000000000000000000000000000000000000000000000000000000000000"),", and will cause incorrect behaviour with odd revert messages."))),(0,i.kt)("br",null),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"allowed-addresses"},"Allowed addresses"),(0,i.kt)("p",null,"You can restrict an address to interact only with specific contracts or EOAs."),(0,i.kt)("p",null,"To restrict an ",(0,i.kt)("inlineCode",{parentName:"p"},"<address>")," to only talk to a specific contract at address ",(0,i.kt)("inlineCode",{parentName:"p"},"<target-contract-address>")," (or additional addresses), the key-value pair below can be set in the ERC725Y contract storage."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"0x4b80742d00000000c6dd0000<address>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"possible values:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[ <target-contract-address>, 0x.... ]"),": an ",(0,i.kt)("strong",{parentName:"li"},"abi-encoded")," array of ",(0,i.kt)("inlineCode",{parentName:"li"},"address[]")," defining the allowed addresses."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"0x")," (empty): if the value is an ",(0,i.kt)("strong",{parentName:"li"},"empty byte")," (= ",(0,i.kt)("inlineCode",{parentName:"li"},"0x"),"), the caller ",(0,i.kt)("inlineCode",{parentName:"li"},"<address>")," is allowed to interact with any address (",(0,i.kt)("strong",{parentName:"li"},"= all addresses are whitelisted"),").")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "AddressPermissions:AllowedAddresses:<address>",\n  "key": "0x4b80742d00000000c6dd0000<address>",\n  "keyType": "Bytes20MappingWithGrouping",\n  "valueType": "address[]",\n  "valueContent": "Address"\n}\n')),(0,i.kt)("br",null),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The allowed addresses MUST be an ",(0,i.kt)("strong",{parentName:"p"},"abi-encoded array")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"address[]")," to ensure the correct behaviour of this functionality."),(0,i.kt)("p",{parentName:"div"},"See the section ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#strict-encoding-mode"},(0,i.kt)("em",{parentName:"a"},"Contract ABI Specification > Strict Encoding Mode"))," in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#"},"Solidity documentation"),"."))),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"allowed-functions"},"Allowed functions"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The allowed functions MUST be an ",(0,i.kt)("strong",{parentName:"p"},"abi-encoded array")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes4[]")," function selectors to ensure the correct behaviour of this functionality."),(0,i.kt)("p",{parentName:"div"},"See the section ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#strict-encoding-mode"},(0,i.kt)("em",{parentName:"a"},"Contract ABI Specification > Strict Encoding Mode"))," in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#"},"Solidity documentation"),"."))),(0,i.kt)("p",null,"You can also restrict which functions a specific address can run by providing a list of ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes4")," function selectors."),(0,i.kt)("p",null,"To restrict an ",(0,i.kt)("inlineCode",{parentName:"p"},"<address>")," to only execute the function ",(0,i.kt)("inlineCode",{parentName:"p"},"transfer(address,uint256)")," (selector: ",(0,i.kt)("inlineCode",{parentName:"p"},"a9059cbb"),"), the following key-value pair can be set in the ERC725Y contract storage."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"0x4b80742d000000008efe0000<address>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"possible values:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[ 0xa9059cbb, 0x... ]"),": an ",(0,i.kt)("strong",{parentName:"li"},"abi-encoded")," array of ",(0,i.kt)("inlineCode",{parentName:"li"},"bytes4[]")," values, definiting the function selectors allowed."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"0x")," (empty): if the value is an ",(0,i.kt)("strong",{parentName:"li"},"empty byte")," (= ",(0,i.kt)("inlineCode",{parentName:"li"},"0x"),"), the caller ",(0,i.kt)("inlineCode",{parentName:"li"},"<address>")," is allowed to execute any function (",(0,i.kt)("strong",{parentName:"li"},"= all ",(0,i.kt)("inlineCode",{parentName:"strong"},"bytes4")," function selectors are whitelisted"),").")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "AddressPermissions:AllowedFunctions:<address>",\n  "key": "0x4b80742d000000008efe0000<address>",\n  "keyType": "Bytes20MappingWithGrouping",\n  "valueType": "bytes4[]",\n  "valueContent": "Bytes4"\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"allowed-standards"},"Allowed standards"),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},'This type of permission does not offer security over the inner workings of a contract. It should be used more as a "mistake prevention" mechanism rather than as a security measure.'))),(0,i.kt)("p",null,"It is possible to restrict an address to interact only with ",(0,i.kt)("strong",{parentName:"p"},"contracts that implement specific interface standards"),". These contracts MUST implement the ",(0,i.kt)("a",{parentName:"p",href:"https://eips.ethereum.org/EIPS/eip-165"},"ERC165 standard")," to be able to detect their interfaces."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Key Manager Allowed Standards flow",src:a(196).Z,width:"1756",height:"569"})),(0,i.kt)("p",null,"As an example, to restrict an ",(0,i.kt)("inlineCode",{parentName:"p"},"<address>")," to only be allowed to interact with ERC725Account contracts (interface ID = ",(0,i.kt)("inlineCode",{parentName:"p"},"0x63cb749b"),"), the following key-value pair can be set in the ERC725Y contract storage."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"0x4b80742d000000003efa0000<address>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"possible values:"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[ 0x63cb749b, 0x... ]"),": an ",(0,i.kt)("strong",{parentName:"li"},"abi-encoded")," array of ",(0,i.kt)("inlineCode",{parentName:"li"},"bytes4[]")," ERC165 interface ids."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"0x")," (empty): if the value is an ",(0,i.kt)("strong",{parentName:"li"},"empty byte")," (= ",(0,i.kt)("inlineCode",{parentName:"li"},"0x"),"), the caller ",(0,i.kt)("inlineCode",{parentName:"li"},"<address>")," is allowed to interact with any contracts, whether they implement a specific standard interface or not.")))),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The allowed standards MUST be an ",(0,i.kt)("strong",{parentName:"p"},"abi-encoded array")," of ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes4[]")," ERC165 interface ids to ensure the correct behaviour of this functionality."),(0,i.kt)("p",{parentName:"div"},"See the section ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#strict-encoding-mode"},(0,i.kt)("em",{parentName:"a"},"Contract ABI Specification > Strict Encoding Mode"))," in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#"},"Solidity documentation"),"."))),(0,i.kt)("h3",{id:"allowed-erc725y-keys"},"Allowed ERC725Y Keys"),(0,i.kt)("p",null,"If an address is allowed to ",(0,i.kt)("inlineCode",{parentName:"p"},"SETDATA")," on an ERC725Account, it is possible to restrict which keys this address can update."),(0,i.kt)("p",null,"To restrict an ",(0,i.kt)("inlineCode",{parentName:"p"},"<address>")," to only be allowed to set the key ",(0,i.kt)("inlineCode",{parentName:"p"},"LSP3Profile")," (",(0,i.kt)("inlineCode",{parentName:"p"},"0x5ef83ad9559033e6e941db7d7c495acdce616347d28e90c7ce47cbfcfcad3bc5"),"), the following key-value pair can be set in the ERC725Y contract storage."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"0x4b80742d0000000090b80000<address>")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"value(s):")," ",(0,i.kt)("inlineCode",{parentName:"li"},"[ 0x5ef83ad9559033e6e941db7d7c495acdce616347d28e90c7ce47cbfcfcad3bc5 ]"))),(0,i.kt)("p",null,"The list (= array) of allowed ",(0,i.kt)("inlineCode",{parentName:"p"},"bytes32")," keys ",(0,i.kt)("strong",{parentName:"p"},"MUST be abi-encoded")," (See the section ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#strict-encoding-mode"},(0,i.kt)("em",{parentName:"a"},"Contract ABI Specification > Strict Encoding Mode")),") in the ",(0,i.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.11/abi-spec.html#"},"Solidity documentation"),"."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("strong",{parentName:"p"},"If no bytes32 values are set, the caller address can set values for any keys.")))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"permission-keys"},"Permission Keys"),(0,i.kt)("p",null,"The following keys are available to set the different types of permissions."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Permission Type"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Key"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#addresspermissionspermissionsaddress"},"Address Permissions")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x4b80742d0000000082ac0000<address>"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#addresspermissionsallowedaddressesaddress"},"Allowed Addresses")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x4b80742d00000000c6dd0000<address>"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#addresspermissionsallowedfunctionsaddress"},"Allowed Functions")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x4b80742d000000008efe0000<address>"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#addresspermissionsallowedstandardsaddress"},"Allowed Standards")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x4b80742d000000003efa0000<address>"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#addresspermissionsallowederc725ykeysaddress"},"Allowed ERC725YKeys")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"0x4b80742d0000000090b80000<address>"))))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#erc725y-keys"},"See LSP6 for more details"))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"permission-values"},"Permission Values"),(0,i.kt)("p",null,"The following default permissions can be set for any address. They are listed according to their order of importance."),(0,i.kt)("p",null,"Click on the toggles below to ",(0,i.kt)("strong",{parentName:"p"},"learn more about the features of each permission"),"."),(0,i.kt)("details",{id:"changeowner"},(0,i.kt)("summary",null,(0,i.kt)("code",null,"CHANGEOWNER")," - Allows changing the owner of the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000001")),(0,i.kt)("p",null,"The ",(0,i.kt)("code",null,"CHANGEOWNER")," permission enables to change the owner of the linked ERC725Account."),(0,i.kt)("p",null,"Using this permission, you can easily upgrade the ",(0,i.kt)("code",null,"KeyManager")," attached to the Account by transferring ownership to a new ",(0,i.kt)("code",null,"KeyManagerV2"),".")),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"CHANGEPERMISSIONS")," - Allows changing existing permissions of addresses"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000002")),(0,i.kt)("p",null,"This permission allows to ",(0,i.kt)("b",null,"edit permissions")," of any address that has already some permissions set on the ERC725Account (including itself)."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"CHANGE Permissions",src:a(3661).Z,width:"1278",height:"782"})),(0,i.kt)("p",null,"Bear in mind that the behaviour of ",(0,i.kt)("code",null,"CHANGEPERMISSIONS")," slightly varies, depending on the new permissions value being set (see figure below)."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"CHANGE Permissions",src:a(2843).Z,width:"1520",height:"657"}))),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"ADDPERMISSIONS")," - Allows giving permissions to new addresses."),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000004")),(0,i.kt)("p",null,"This permission allows to give permissions to new addresses. Or in other words, it enables to ",(0,i.kt)("b",null,"authorize new addresses")," to interact with the ERC725Account."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"ADD Permissions",src:a(2704).Z,width:"1476",height:"677"}))),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"SETDATA")," - Allows setting data on the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000008")),"Allows an address to write any form of data in the ",(0,i.kt)("a",{href:"https://**github**.com/ethereum/EIPs/blob/master/EIPS/eip-725.md#erc725y"},"ERC725Y")," key-value store of the linked ",(0,i.kt)("code",null,"ERC725Account")," (except permissions, that requires the permissions ",(0,i.kt)("code",null,"CHANGEPERMISSIONS")," described above)."),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"CALL")," - Allows calling other contracts through the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000010"),(0,i.kt)("br",null)),(0,i.kt)("p",null,"This permission enables anyone to use the ERC725Account linked to Key Manager to make external calls (to contracts or Externally Owned Accounts). Allowing state changes at the address being called.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"STATICCALL")," - Allows calling other contracts through the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000020"),(0,i.kt)("br",null)),(0,i.kt)("p",null,"This permission enables to use the ERC725Account linked to Key Manager to make external calls to contracts while disallowing state changes at the address being called."),(0,i.kt)("p",null,"It uses the ",(0,i.kt)("a",{href:"https://eips.ethereum.org/EIPS/eip-214"},(0,i.kt)("code",null,"STATICCALL"))," opcode when performing the external call."),(0,i.kt)("blockquote",null,"If any state is changed at a target contract through a ",(0,i.kt)("code",null,"STATICCALL"),", the call will revert.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"DELEGATECALL")," - Allows delegate calling other contracts through the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000040")),(0,i.kt)("p",null,"This permission to execute code and functions from other contracts in the context of the UP."),(0,i.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"DELEGATECALL"))," is currently disallowed (even if set on the KeyManager) because of its dangerous nature, as some malicious code can be executed in the context of the linked Account contract.")))),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"DEPLOY")," - Allows deploying other contracts through the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000080")),(0,i.kt)("p",null,"Enables the caller to deploy a smart contract, using the linked ERC725Account as a deployer. The bytecode of the contract to be deployed should be provided in the payload (abi-encoded) passed to the Key Manager."),(0,i.kt)("blockquote",null,"Both the ",(0,i.kt)("code",null,"CREATE")," or ",(0,i.kt)("a",{href:"https://eips.ethereum.org/EIPS/eip-1014"},(0,i.kt)("code",null,"CREATE2"))," opcode can be used to deploy the contract.")),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"TRANSFERVALUE")," - Allows transfering value to other contracts from the controlled contract"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000100")),"Enables to send native currency from the linked ERC725Account to any address.",(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("blockquote",null,"NB: for a simple native token transfer, no data (",(0,i.kt)("code",null,'""'),") should be passed to the fourth parameter of the ",(0,i.kt)("code",null,"execute")," function of the Account contract.",(0,i.kt)("br",null),"For instance: ",(0,i.kt)("code",null,'account.execute(operationCall, recipient, amount, "")'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,(0,i.kt)("code",null,"SIGN"),": Allows signing on behalf of the controlled account, for example for login purposes"),(0,i.kt)("p",{style:{marginBottom:"3%",marginTop:"2%",textAlign:"center"}},(0,i.kt)("b",null,"value = "),(0,i.kt)("code",null,"0x0000000000000000000000000000000000000000000000000000000000000200")),"The ",(0,i.kt)("code",null,"SIGN")," permission can be used for keys to sign login messages. It is mostly for web2.0 apps to know which key SHOULD sign."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Permissions can be combined together"),", if an address needs to hold more than one permission."),(0,i.kt)("p",null,"Simply calculate the sum of their decimal value, and convert the result back into hexadecimal. For instance:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("a",{parentName:"p",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md#permission-values-in-addresspermissionspermissionsaddress"},"See LSP6 Specs for more details"))),(0,i.kt)(c,{mdxType:"Tabs"},(0,i.kt)(k,{value:"example1",label:"Example 1",default:!0,mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"permissions: CALL + TRANSFERVALUE\n\n  0x0000000000000000000000000000000000000000000000000000000000000010 (16 in decimal)\n+ 0x0000000000000000000000000000000000000000000000000000000000000100 (256)\n---------------------------------------------------------------------\n= 0x0000000000000000000000000000000000000000000000000000000000000110 (= 272)\n"))),(0,i.kt)(k,{value:"example2",label:"Example 2",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-solidity"},"permissions: CHANGEPERMISSIONS + SETDATA\n\n  0x0000000000000000000000000000000000000000000000000000000000000002 (2 in decimal)\n+ 0x0000000000000000000000000000000000000000000000000000000000000008 (8)\n---------------------------------------------------------------------\n= 0x000000000000000000000000000000000000000000000000000000000000000a (= 10)\n")))),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You can easily ",(0,i.kt)("a",{parentName:"p",href:"../../../../tools/erc725js/classes/ERC725#encodepermissions"},(0,i.kt)("inlineCode",{parentName:"a"},"encodePermissions"))," and ",(0,i.kt)("a",{parentName:"p",href:"../../../../tools/erc725js/classes/ERC725#decodepermissions"},(0,i.kt)("inlineCode",{parentName:"a"},"decodePermissions"))," with ",(0,i.kt)("a",{parentName:"p",href:"../../../../tools/erc725js/getting-started"},(0,i.kt)("strong",{parentName:"a"},"erc725.js")),"."))),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"When deployed with our ",(0,i.kt)("a",{parentName:"p",href:"https://docs.lukso.tech/tools/lsp-factoryjs/introduction/getting-started/"},(0,i.kt)("strong",{parentName:"a"},"lsp-factory.js")," tool"),", the Universal Profile owner will have all the permissions above set by default."))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md"},"LUKSO Standards Proposals: LSP6 - Key Manager (Standard Specification, GitHub)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/lukso-network/lsp-universalprofile-smart-contracts/tree/develop/contracts/LSP6KeyManager"},"LSP6 KeyManager: Solidity implementations (GitHub)"))))}h.isMDXComponent=!0},2704:function(e,t,a){t.Z=a.p+"assets/images/lsp6-add-permissions-70e9cfb2add35fd2e3f212642b909d6f.jpeg"},2843:function(e,t,a){t.Z=a.p+"assets/images/lsp6-change-permissions-variants-2a5bb0c8d5d43e3addbbc61df8d60ae7.jpeg"},3661:function(e,t,a){t.Z=a.p+"assets/images/lsp6-change-permissions-55ed624a16cd52b39d9068f5082344ef.jpeg"},196:function(e,t,a){t.Z=a.p+"assets/images/lsp6-key-manager-allowed-standards-5c89aae7c18146b7addaefd125e003dd.jpeg"},9411:function(e,t,a){t.Z=a.p+"assets/images/lsp6-key-manager-overview-allowed-f885542275e24c63597ed0c75c74f515.jpeg"},5220:function(e,t,a){t.Z=a.p+"assets/images/lsp6-key-manager-overview-not-allowed-af8b9154f59c83b5afbdcd13418085b2.jpeg"}}]);